<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>Babelshark: TreeVisitor Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.9 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>TreeVisitor Class Reference</h1><!-- doxytag: class="TreeVisitor" --><!-- doxytag: inherits="PDI::ConstVisitor" --><div class="dynheader">
Inheritance diagram for TreeVisitor:</div>
<div class="dynsection">

<p><center><img src="class_tree_visitor.png" usemap="#TreeVisitor_map" border="0" alt=""></center>
<map name="TreeVisitor_map">
<area href="class_p_d_i_1_1_const_visitor.html" alt="PDI::ConstVisitor" shape="rect" coords="0,0,106,24">
<area href="class_static_tree_visitor.html" alt="StaticTreeVisitor" shape="rect" coords="0,112,106,136">
</map>
</div>

<p>
<a href="class_tree_visitor-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#83c6b4c595156e7364646894e8063d4d">TreeVisitor</a> (const std::string &amp;sName, bool bDisplayOutputToScreen=false)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_babel_shark_1_1_instruction.html">BabelShark::Instruction</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#5aec3878d33d8942c16e1cfe38ca9371">GetInstruction</a> ()</td></tr>

<tr><td colspan="2"><br><h2>Protected Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef <br class="typebreak">
<a class="el" href="class_babel_shark_1_1_instruction.html">BabelShark::Instruction</a> <br class="typebreak">
*(TreeVisitor::*&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#b86b90c59cfab89234559cc850e03d41">CreateInstructionFunc</a> )(const std::string &amp;, const std::string &amp;, const std::string &amp;)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef std::map&lt; std::string, <br class="typebreak">
<a class="el" href="class_tree_visitor.html#b86b90c59cfab89234559cc850e03d41">CreateInstructionFunc</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#67a93ec07faec8f86504e14f741cd43d">CreateInstructionFuncMap</a></td></tr>

<tr><td colspan="2"><br><h2>Protected Member Functions</h2></td></tr>
<tr><td class="memTemplParams" nowrap colspan="2">template&lt;typename InstructionTypeT &gt; </td></tr>
<tr><td class="memTemplItemLeft" nowrap align="right" valign="top"><a class="el" href="class_babel_shark_1_1_instruction.html">BabelShark::Instruction</a> *&nbsp;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#9d864fd348d43a60d601a831ca56ab3c">CreateInstruction</a> (const std::string &amp;sSize, const std::string &amp;sName, const std::string &amp;sVariable)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#9d9bcb690e82d4ce37a60cb719080728">Visit</a> (const <a class="el" href="class_p_d_i_1_1_array.html">PDI::Array</a> &amp;array)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#743376c17f517556962c3eb18645a78e">Visit</a> (const <a class="el" href="class_p_d_i_1_1_display_element.html">PDI::DisplayElement</a> &amp;string)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#43a9f62cc523fba70fd69177ae9efe00">Visit</a> (const <a class="el" href="class_p_d_i_1_1_null.html">PDI::Null</a> &amp;null)</td></tr>

<tr><td colspan="2"><br><h2>Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_tree_visitor.html#67a93ec07faec8f86504e14f741cd43d">CreateInstructionFuncMap</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#5118f3dbb7fe1f1e0858dcce730883f7">m_CreateInstructionFuncMap</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">std::string&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#5741289c6228228f87981e0f98f5728d">m_sName</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="class_babel_shark_1_1_instruction.html">BabelShark::Instruction</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#bfc1d38adea2b98fa6f2d064bc4f3f3a">m_pInstruction</a></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_tree_visitor.html#85a29552ac35ad8d914f0bf3eb404108">m_bDisplayOutputToScreen</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
The <a class="el" href="class_tree_visitor.html">TreeVisitor</a> class is used to visit (iterate over) each item in the Tree which is created by reading in a file in <a class="el" href="namespace_p_d_i.html">PDI</a> format. When a node on the tree is visited, an instruction is created in the Instruction Tree. The Wireshark dissector will use the instruction tree created by this class.<p>
Usage: After a file has been read in by calling the following parser functions... Element elemRoot = DisplayElement(); Reader::Read(elemRoot, std::ifstream("AvatarsInRoom.txt")); then the following function can be called to create an instruction tree. <a class="el" href="class_tree_visitor.html">TreeVisitor</a> treeVisitor(elemRoot.Name()); Note that the root element name must be passed into the <a class="el" href="class_tree_visitor.html">TreeVisitor</a> in order to get the first name from the file to be included in the first instruction in the instruction tree.<p>
If a second parameter is provided, which is boolean, this will be used to determine if unit test / debug data should be written to cout. If the parameter is true then data will be displayed. If the parameter is false, or is not provided, then data will not be displayed. <hr><h2>Member Typedef Documentation</h2>
<a class="anchor" name="b86b90c59cfab89234559cc850e03d41"></a><!-- doxytag: member="TreeVisitor::CreateInstructionFunc" ref="b86b90c59cfab89234559cc850e03d41" args=")(const std::string &amp;, const std::string &amp;, const std::string &amp;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef <a class="el" href="class_babel_shark_1_1_instruction.html">BabelShark::Instruction</a>*(TreeVisitor::* <a class="el" href="class_tree_visitor.html#b86b90c59cfab89234559cc850e03d41">TreeVisitor::CreateInstructionFunc</a>)(const std::string &amp;, const std::string &amp;, const std::string &amp;)<code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="67a93ec07faec8f86504e14f741cd43d"></a><!-- doxytag: member="TreeVisitor::CreateInstructionFuncMap" ref="67a93ec07faec8f86504e14f741cd43d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;std::string, <a class="el" href="class_tree_visitor.html#b86b90c59cfab89234559cc850e03d41">CreateInstructionFunc</a>&gt; <a class="el" href="class_tree_visitor.html#67a93ec07faec8f86504e14f741cd43d">TreeVisitor::CreateInstructionFuncMap</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="83c6b4c595156e7364646894e8063d4d"></a><!-- doxytag: member="TreeVisitor::TreeVisitor" ref="83c6b4c595156e7364646894e8063d4d" args="(const std::string &amp;sName, bool bDisplayOutputToScreen=false)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">TreeVisitor::TreeVisitor           </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>sName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>bDisplayOutputToScreen</em> = <code>false</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
This is the constructor for <a class="el" href="class_tree_visitor.html">TreeVisitor</a> class.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sName</em>&nbsp;</td><td>the name of the root node. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bDisplayOutputToScreen</em>&nbsp;</td><td>(optional) should be true if you want output to the screen for testing</td></tr>
  </table>
</dl>
A function map is initialized in the constructor using a template. This will make the addition of new types easier. 
</div>
</div><p>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="9d864fd348d43a60d601a831ca56ab3c"></a><!-- doxytag: member="TreeVisitor::CreateInstruction" ref="9d864fd348d43a60d601a831ca56ab3c" args="(const std::string &amp;sSize, const std::string &amp;sName, const std::string &amp;sVariable)" -->
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename InstructionTypeT &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_babel_shark_1_1_instruction.html">BabelShark::Instruction</a>* TreeVisitor::CreateInstruction           </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>sSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>sName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&nbsp;</td>
          <td class="paramname"> <em>sVariable</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="class_tree_visitor.html#9d864fd348d43a60d601a831ca56ab3c">CreateInstruction()</a> uses a template to reduce code size and to make it easier to add new types. There are 3 pieces of data that an instruction needs: name, type, size. Size and name are passed in as parameters. The Type is known because this is a template function and it is InstructionTypeT.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>sSize</em>&nbsp;</td><td>The size of the piece to dissect from the message. This may be in bits, bytes, or a string. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sName</em>&nbsp;</td><td>The name to display in wireshark for this piece of data. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sVariable</em>&nbsp;</td><td>(Optional) Some instructions will have an optional varaible name which can be used in another part of the <a class="el" href="namespace_p_d_i.html">PDI</a> file, to refer to the value obtained from the message buffer for this instruction. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="5aec3878d33d8942c16e1cfe38ca9371"></a><!-- doxytag: member="TreeVisitor::GetInstruction" ref="5aec3878d33d8942c16e1cfe38ca9371" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_babel_shark_1_1_instruction.html">BabelShark::Instruction</a>* TreeVisitor::GetInstruction           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="class_tree_visitor.html#5aec3878d33d8942c16e1cfe38ca9371">GetInstruction()</a> returns a pointer to an instruction. 
</div>
</div><p>
<a class="anchor" name="43a9f62cc523fba70fd69177ae9efe00"></a><!-- doxytag: member="TreeVisitor::Visit" ref="43a9f62cc523fba70fd69177ae9efe00" args="(const PDI::Null &amp;null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void TreeVisitor::Visit           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_p_d_i_1_1_null.html">PDI::Null</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>null</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="class_tree_visitor.html#9d9bcb690e82d4ce37a60cb719080728">Visit()</a> is used to visit a NULL_ELEMENT. This was kept in for completeness. It's a good idea to still have the NULL_ELEMENT enum value so we can default the type of a new element to NULL_ELEMENT. However, we should never be visiting a NULL_ELEMENT, so an exception in thrown. 
<p>Implements <a class="el" href="class_p_d_i_1_1_const_visitor.html#bfd97412ff9c3184f22e733eaf3c2dbf">PDI::ConstVisitor</a>.</p>

</div>
</div><p>
<a class="anchor" name="743376c17f517556962c3eb18645a78e"></a><!-- doxytag: member="TreeVisitor::Visit" ref="743376c17f517556962c3eb18645a78e" args="(const PDI::DisplayElement &amp;string)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void TreeVisitor::Visit           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_p_d_i_1_1_display_element.html">PDI::DisplayElement</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>string</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="class_tree_visitor.html#9d9bcb690e82d4ce37a60cb719080728">Visit()</a> is used to visit a DisplayElement. It creates one instruction for the DisplayElement. It uses a template in order to reduce code. It looks in the function map for a known type and then calls the appropriate function to create the instruction that matches the desired type. For example, if ASCII is the type, then an AsciiElement instruction is created and added to the instruction tree.<p>
For phase 2, the concept of display element has been expanded to include rows in the <a class="el" href="namespace_p_d_i.html">PDI</a> file which are where a statictype is used or a dynamictype is used.<p>
DISPLAY_ELEMENT can be any one of the following formats: "NameSimple" : "Type Size" "NameSimpleWithVariable" : "Type Size $Optional_Variable" "NameStaticTypeUsage" : "&amp;Alias Size" "NameDynamicTypeUsage" : "&amp;Alias($Variable) Size" 
<p>Implements <a class="el" href="class_p_d_i_1_1_const_visitor.html#524441ec45975a709fede105f8c30361">PDI::ConstVisitor</a>.</p>

</div>
</div><p>
<a class="anchor" name="9d9bcb690e82d4ce37a60cb719080728"></a><!-- doxytag: member="TreeVisitor::Visit" ref="9d9bcb690e82d4ce37a60cb719080728" args="(const PDI::Array &amp;array)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual void TreeVisitor::Visit           </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_p_d_i_1_1_array.html">PDI::Array</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>array</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="class_tree_visitor.html#9d9bcb690e82d4ce37a60cb719080728">Visit()</a> iterates over all items in the array. It calls a visit function on each item. It passes in the name of the array for the same reason that we needed to pass the name of the root node into the constructor, so that it would be available to use when we create the instruction.<p>
Each item in the array is added to an instruction set. 
<p>Implements <a class="el" href="class_p_d_i_1_1_const_visitor.html#7a7cf2134195f958a2d5eeeb6cfc2561">PDI::ConstVisitor</a>.</p>

<p>Reimplemented in <a class="el" href="class_static_tree_visitor.html#3e661b2e248b2e47cbb5b20ef2d045cc">StaticTreeVisitor</a>.</p>

</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="85a29552ac35ad8d914f0bf3eb404108"></a><!-- doxytag: member="TreeVisitor::m_bDisplayOutputToScreen" ref="85a29552ac35ad8d914f0bf3eb404108" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool <a class="el" href="class_tree_visitor.html#85a29552ac35ad8d914f0bf3eb404108">TreeVisitor::m_bDisplayOutputToScreen</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="5118f3dbb7fe1f1e0858dcce730883f7"></a><!-- doxytag: member="TreeVisitor::m_CreateInstructionFuncMap" ref="5118f3dbb7fe1f1e0858dcce730883f7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_tree_visitor.html#67a93ec07faec8f86504e14f741cd43d">CreateInstructionFuncMap</a> <a class="el" href="class_tree_visitor.html#5118f3dbb7fe1f1e0858dcce730883f7">TreeVisitor::m_CreateInstructionFuncMap</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="bfc1d38adea2b98fa6f2d064bc4f3f3a"></a><!-- doxytag: member="TreeVisitor::m_pInstruction" ref="bfc1d38adea2b98fa6f2d064bc4f3f3a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_babel_shark_1_1_instruction.html">BabelShark::Instruction</a>* <a class="el" href="class_tree_visitor.html#bfc1d38adea2b98fa6f2d064bc4f3f3a">TreeVisitor::m_pInstruction</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<a class="anchor" name="5741289c6228228f87981e0f98f5728d"></a><!-- doxytag: member="TreeVisitor::m_sName" ref="5741289c6228228f87981e0f98f5728d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::string <a class="el" href="class_tree_visitor.html#5741289c6228228f87981e0f98f5728d">TreeVisitor::m_sName</a><code> [protected]</code>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li><a class="el" href="_tree_visitor_8h_source.html">TreeVisitor.h</a></ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Jul 6 00:35:32 2009 for Babelshark by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.9 </small></address>
</body>
</html>
